%{
   Code to calculate the sheath admittance

	ytot(w,wci,bx,xi,jdc)
	
where normalized (dimensionless) variables are used throughout

	w = rf frequency
	wci = ion cyclotron frequency
	bx = normal component of b, (bx = 1 for perp. sheath)
	xi = e Vrf / Te  where Vrf = 0 to peak amplitude (not peak-to-peak)
	jdc = Jdc/(ni0 e cs) =  normalized DC current density flowing through the sheath
	
Individual contributions are

	ye(bx,xi) = electron admittance
	yd(w,wci,bx,xi) = displacement admittance
	yi(w,wci,bx,xi) = ion admittance
	
The sheath impedance is z = 1/ytot.  To convert dimensionless impedance z to CGS or SI units see

J. R. Myra and D. A. D'Ippolito, Physics of Plasmas 22, 062507 (2015), Appendix A
http://dx.doi.org/10.1063/1.4922848

The code is based upon work described in

Physics-based parametrization of the surface impedance for radio frequency sheaths
J. R. Myra
Physics of Plasmas 24, 072507 (2017)
http://dx.doi.org/10.1063/1.4990373

This version (v3.2) implements an upgrate to include the JDC as described in

Effect of net direct current on the properties of radio frequency sheaths: simulation and cross-code comparison
J. R. Myra, M.T. Elias, D. Curreli, and T. G. Jenkins
submitted to Nucl. Fusion
http://www.lodestar.com/LRCreports/Myra_DC_current_carrying_RF_sheaths_LRC-20-186.pdf

%}

w=13.56e6;
wci=1;

mu=0.2417E2;
upar0=0.11E1;
ff=0.E-307+(1+0.113352E1.*xi+0.124171E1.*xi.^2).^(-1).*(0.318511E1+ ...
  0.370285E1.*xi+0.381991E1.*xi.^2+0.790497E0.*xi.^3)+(-1).*log(1+( ...
  -0.909091E0).*jdc);
gg=0.966463E0+0.141639E0.*tanh(w);
phi0avg=0.E-307+(-1).*log(1+(-0.909091E0).*jdc)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3);
niw=0.794443E0.*((0.100009E1+0.645662E0.*(wci.*(vv+(1+0.995721E0.*wci.^2) ...
  .^(-1).*log(0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))).^(1/4)) ...
  .^0.291118E1).^(-1).*(0.902215E-4+bx.^2+0.645662E0.*(wci.*(vv+(1+ ...
  0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+0.584189E3.*bx.^2).^( ...
  1/2))).^(1/4)).^0.291118E1)).^(1/2).*(0.182379E0+(vv+(1+0.995721E0.* ...
  wci.^2).^(-1).*log(0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))).^(1/2)) ...
  .^(-1);
niww=0.794443E0.*Re(((0.100009E1+0.645662E0.*(wci.*(0.37617E1+0.22202E0.*(( ...
  -0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+ ...
  0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1) ...
  +(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/4)) ...
  .^0.291118E1).^(-1).*(0.902215E-4+bx.^2+0.645662E0.*(wci.*(0.37617E1+ ...
  0.22202E0.*((-0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log( ...
  0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).* ...
  jdc)+((-0.37617E1)+(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*( ...
  0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)) ...
  .^(1/4)).^0.291118E1)).^(1/2).*(0.182379E0+(0.37617E1+0.22202E0.*(( ...
  -0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+ ...
  0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1) ...
  +(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/2)).^(-1));
yd=(0.E-307+sqrt(-1)*(-0.100198E1)).*w.*(Re(((0.100009E1+0.645662E0.*( ...
  wci.*(0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^( ...
  -1).*log(0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+( ...
  -0.909091E0).*jdc)+((-0.37617E1)+(-0.22202E0).*((-0.37617E1)+xi)+(1+ ...
  0.113352E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*( ...
  0.966463E0+0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*( ...
  0.966463E0+0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh( ...
  w)).^3)).*tanh(w)).^(1/4)).^0.291118E1).^(-1).*(0.902215E-4+bx.^2+ ...
  0.645662E0.*(wci.*(0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+ ...
  0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+0.584189E3.*bx.^2).^( ...
  1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1)+(-0.22202E0).*(( ...
  -0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+ ...
  0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2).^(-1).*( ...
  0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+0.381991E1.* ...
  xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.*xi.^3.*( ...
  0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/4)).^0.291118E1)).^( ...
  1/2).*(0.182379E0+(0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+ ...
  0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+0.584189E3.*bx.^2).^( ...
  1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1)+(-0.22202E0).*(( ...
  -0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+ ...
  0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2).^(-1).*( ...
  0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+0.381991E1.* ...
  xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.*xi.^3.*( ...
  0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/2)).^(-1)).^(-1).*( ...
  0.E-307+(-1).*log(1+(-0.909091E0).*jdc)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3))).^(-1/2);
he=(1+0.607405E0.*xi+0.325497E0.*xi.^2).*(1+0.624392E0.*xi+0.500595E0.* ...
  xi.^2+0.255644E0.*xi.^3).^(-1);
ye=0.105704E1.*(1+(-0.909091E0).*jdc).*(1+0.607405E0.*xi+0.325497E0.*xi.^2) ...
  .*(1+0.624392E0.*xi+0.500595E0.*xi.^2+0.255644E0.*xi.^3).^(-1).*abs(bx); ...
  
yi=(0.E-307+sqrt(-1)*0.761699E0).*w.*Re(((0.100009E1+0.645662E0.*(wci.*( ...
  0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).* ...
  log(0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0) ...
  .*jdc)+((-0.37617E1)+(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.* ...
  (0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)) ...
  .^(1/4)).^0.291118E1).^(-1).*(0.902215E-4+bx.^2+0.645662E0.*(wci.*( ...
  0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).* ...
  log(0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0) ...
  .*jdc)+((-0.37617E1)+(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.* ...
  (0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)) ...
  .^(1/4)).^0.291118E1)).^(1/2).*(0.182379E0+(0.37617E1+0.22202E0.*(( ...
  -0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+ ...
  0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1) ...
  +(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/2)).^(-1)).^( ...
  1/2).*((-0.797659E0)+0.825076E0.*w.^2.*((0.E-307+sqrt(-1)*0.1E-3)+w.^2+( ...
  -1).*wci.^2).*((0.E-307+sqrt(-1)*0.1E-3)+w.^2+(-1).*bx.^2.*wci.^2).^( ...
  -1).*Re(((0.100009E1+0.645662E0.*(wci.*(0.37617E1+0.22202E0.*(( ...
  -0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+ ...
  0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1) ...
  +(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/4)) ...
  .^0.291118E1).^(-1).*(0.902215E-4+bx.^2+0.645662E0.*(wci.*(0.37617E1+ ...
  0.22202E0.*((-0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log( ...
  0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).* ...
  jdc)+((-0.37617E1)+(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*( ...
  0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)) ...
  .^(1/4)).^0.291118E1)).^(1/2).*(0.182379E0+(0.37617E1+0.22202E0.*(( ...
  -0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+ ...
  0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1) ...
  +(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/2)).^(-1)).^( ...
  -1)+(0.E-307+sqrt(-1)*0.168537E1).*w.*abs(bx).*Re(((0.100009E1+ ...
  0.645662E0.*(wci.*(0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+ ...
  0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+0.584189E3.*bx.^2).^( ...
  1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1)+(-0.22202E0).*(( ...
  -0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+ ...
  0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2).^(-1).*( ...
  0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+0.381991E1.* ...
  xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.*xi.^3.*( ...
  0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/4)).^0.291118E1).^( ...
  -1).*(0.902215E-4+bx.^2+0.645662E0.*(wci.*(0.37617E1+0.22202E0.*(( ...
  -0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+ ...
  0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1) ...
  +(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/4)) ...
  .^0.291118E1)).^(1/2).*(0.182379E0+(0.37617E1+0.22202E0.*((-0.37617E1)+ ...
  xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+0.584189E3.* ...
  bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1)+( ...
  -0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/2)).^(-1)).^( ...
  -3/2).*(0.E-307+(-1).*log(1+(-0.909091E0).*jdc)+(1+0.113352E1.*xi.*( ...
  0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).^(-1/2)).^( ...
  -1).*(0.E-307+(-1).*log(1+(-0.909091E0).*jdc)+(1+0.113352E1.*xi.*( ...
  0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).^(-1/2);
ytot=0.105704E1.*(1+(-0.909091E0).*jdc).*(1+0.607405E0.*xi+0.325497E0.*xi.^2) ...
  .*(1+0.624392E0.*xi+0.500595E0.*xi.^2+0.255644E0.*xi.^3).^(-1).*abs(bx)+ ...
  (0.E-307+sqrt(-1)*0.761699E0).*w.*Re(((0.100009E1+0.645662E0.*(wci.*( ...
  0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).* ...
  log(0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0) ...
  .*jdc)+((-0.37617E1)+(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.* ...
  (0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)) ...
  .^(1/4)).^0.291118E1).^(-1).*(0.902215E-4+bx.^2+0.645662E0.*(wci.*( ...
  0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).* ...
  log(0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0) ...
  .*jdc)+((-0.37617E1)+(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.* ...
  (0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)) ...
  .^(1/4)).^0.291118E1)).^(1/2).*(0.182379E0+(0.37617E1+0.22202E0.*(( ...
  -0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+ ...
  0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1) ...
  +(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/2)).^(-1)).^( ...
  1/2).*((-0.797659E0)+0.825076E0.*w.^2.*((0.E-307+sqrt(-1)*0.1E-3)+w.^2+( ...
  -1).*wci.^2).*((0.E-307+sqrt(-1)*0.1E-3)+w.^2+(-1).*bx.^2.*wci.^2).^( ...
  -1).*Re(((0.100009E1+0.645662E0.*(wci.*(0.37617E1+0.22202E0.*(( ...
  -0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+ ...
  0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1) ...
  +(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/4)) ...
  .^0.291118E1).^(-1).*(0.902215E-4+bx.^2+0.645662E0.*(wci.*(0.37617E1+ ...
  0.22202E0.*((-0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log( ...
  0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).* ...
  jdc)+((-0.37617E1)+(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*( ...
  0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)) ...
  .^(1/4)).^0.291118E1)).^(1/2).*(0.182379E0+(0.37617E1+0.22202E0.*(( ...
  -0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+ ...
  0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1) ...
  +(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/2)).^(-1)).^( ...
  -1)+(0.E-307+sqrt(-1)*0.168537E1).*w.*abs(bx).*Re(((0.100009E1+ ...
  0.645662E0.*(wci.*(0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+ ...
  0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+0.584189E3.*bx.^2).^( ...
  1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1)+(-0.22202E0).*(( ...
  -0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+ ...
  0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2).^(-1).*( ...
  0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+0.381991E1.* ...
  xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.*xi.^3.*( ...
  0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/4)).^0.291118E1).^( ...
  -1).*(0.902215E-4+bx.^2+0.645662E0.*(wci.*(0.37617E1+0.22202E0.*(( ...
  -0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+ ...
  0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1) ...
  +(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/4)) ...
  .^0.291118E1)).^(1/2).*(0.182379E0+(0.37617E1+0.22202E0.*((-0.37617E1)+ ...
  xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+0.584189E3.* ...
  bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1)+( ...
  -0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/2)).^(-1)).^( ...
  -3/2).*(0.E-307+(-1).*log(1+(-0.909091E0).*jdc)+(1+0.113352E1.*xi.*( ...
  0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).^(-1/2)).^( ...
  -1).*(0.E-307+(-1).*log(1+(-0.909091E0).*jdc)+(1+0.113352E1.*xi.*( ...
  0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).^(-1/2)+( ...
  0.E-307+sqrt(-1)*(-0.100198E1)).*w.*(Re(((0.100009E1+0.645662E0.*(wci.* ...
  (0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).* ...
  log(0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0) ...
  .*jdc)+((-0.37617E1)+(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.* ...
  (0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)) ...
  .^(1/4)).^0.291118E1).^(-1).*(0.902215E-4+bx.^2+0.645662E0.*(wci.*( ...
  0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).* ...
  log(0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0) ...
  .*jdc)+((-0.37617E1)+(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.* ...
  (0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)) ...
  .^(1/4)).^0.291118E1)).^(1/2).*(0.182379E0+(0.37617E1+0.22202E0.*(( ...
  -0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+ ...
  0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1) ...
  +(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/2)).^(-1)).^( ...
  -1).*(0.E-307+(-1).*log(1+(-0.909091E0).*jdc)+(1+0.113352E1.*xi.*( ...
  0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3))).^(-1/2);
ztot=(0.105704E1.*(1+(-0.909091E0).*jdc).*(1+0.607405E0.*xi+0.325497E0.* ...
  xi.^2).*(1+0.624392E0.*xi+0.500595E0.*xi.^2+0.255644E0.*xi.^3).^(-1).* ...
  abs(bx)+(0.E-307+sqrt(-1)*0.761699E0).*w.*Re(((0.100009E1+0.645662E0.*( ...
  wci.*(0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^( ...
  -1).*log(0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+( ...
  -0.909091E0).*jdc)+((-0.37617E1)+(-0.22202E0).*((-0.37617E1)+xi)+(1+ ...
  0.113352E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*( ...
  0.966463E0+0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*( ...
  0.966463E0+0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh( ...
  w)).^3)).*tanh(w)).^(1/4)).^0.291118E1).^(-1).*(0.902215E-4+bx.^2+ ...
  0.645662E0.*(wci.*(0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+ ...
  0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+0.584189E3.*bx.^2).^( ...
  1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1)+(-0.22202E0).*(( ...
  -0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+ ...
  0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2).^(-1).*( ...
  0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+0.381991E1.* ...
  xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.*xi.^3.*( ...
  0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/4)).^0.291118E1)).^( ...
  1/2).*(0.182379E0+(0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+ ...
  0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+0.584189E3.*bx.^2).^( ...
  1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1)+(-0.22202E0).*(( ...
  -0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+ ...
  0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2).^(-1).*( ...
  0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+0.381991E1.* ...
  xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.*xi.^3.*( ...
  0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/2)).^(-1)).^(1/2).*(( ...
  -0.797659E0)+0.825076E0.*w.^2.*((0.E-307+sqrt(-1)*0.1E-3)+w.^2+(-1).* ...
  wci.^2).*((0.E-307+sqrt(-1)*0.1E-3)+w.^2+(-1).*bx.^2.*wci.^2).^(-1).* ...
  Re(((0.100009E1+0.645662E0.*(wci.*(0.37617E1+0.22202E0.*((-0.37617E1)+ ...
  xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+0.584189E3.* ...
  bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1)+( ...
  -0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/4)) ...
  .^0.291118E1).^(-1).*(0.902215E-4+bx.^2+0.645662E0.*(wci.*(0.37617E1+ ...
  0.22202E0.*((-0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log( ...
  0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).* ...
  jdc)+((-0.37617E1)+(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*( ...
  0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)) ...
  .^(1/4)).^0.291118E1)).^(1/2).*(0.182379E0+(0.37617E1+0.22202E0.*(( ...
  -0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+ ...
  0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1) ...
  +(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/2)).^(-1)).^( ...
  -1)+(0.E-307+sqrt(-1)*0.168537E1).*w.*abs(bx).*Re(((0.100009E1+ ...
  0.645662E0.*(wci.*(0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+ ...
  0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+0.584189E3.*bx.^2).^( ...
  1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1)+(-0.22202E0).*(( ...
  -0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+ ...
  0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2).^(-1).*( ...
  0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w))+0.381991E1.* ...
  xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.*xi.^3.*( ...
  0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/4)).^0.291118E1).^( ...
  -1).*(0.902215E-4+bx.^2+0.645662E0.*(wci.*(0.37617E1+0.22202E0.*(( ...
  -0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+ ...
  0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1) ...
  +(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/4)) ...
  .^0.291118E1)).^(1/2).*(0.182379E0+(0.37617E1+0.22202E0.*((-0.37617E1)+ ...
  xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+0.584189E3.* ...
  bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1)+( ...
  -0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/2)).^(-1)).^( ...
  -3/2).*(0.E-307+(-1).*log(1+(-0.909091E0).*jdc)+(1+0.113352E1.*xi.*( ...
  0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).^(-1/2)).^( ...
  -1).*(0.E-307+(-1).*log(1+(-0.909091E0).*jdc)+(1+0.113352E1.*xi.*( ...
  0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).^(-1/2)+( ...
  0.E-307+sqrt(-1)*(-0.100198E1)).*w.*(Re(((0.100009E1+0.645662E0.*(wci.* ...
  (0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).* ...
  log(0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0) ...
  .*jdc)+((-0.37617E1)+(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.* ...
  (0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)) ...
  .^(1/4)).^0.291118E1).^(-1).*(0.902215E-4+bx.^2+0.645662E0.*(wci.*( ...
  0.37617E1+0.22202E0.*((-0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).* ...
  log(0.413382E-1.*(1+0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0) ...
  .*jdc)+((-0.37617E1)+(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.* ...
  (0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)) ...
  .^(1/4)).^0.291118E1)).^(1/2).*(0.182379E0+(0.37617E1+0.22202E0.*(( ...
  -0.37617E1)+xi)+(1+0.995721E0.*wci.^2).^(-1).*log(0.413382E-1.*(1+ ...
  0.584189E3.*bx.^2).^(1/2))+(-1).*log(1+(-0.909091E0).*jdc)+((-0.37617E1) ...
  +(-0.22202E0).*((-0.37617E1)+xi)+(1+0.113352E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+0.141639E0.*tanh(w)) ...
  +0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)).^2+0.790497E0.* ...
  xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3)).*tanh(w)).^(1/2)).^(-1)).^( ...
  -1).*(0.E-307+(-1).*log(1+(-0.909091E0).*jdc)+(1+0.113352E1.*xi.*( ...
  0.966463E0+0.141639E0.*tanh(w))+0.124171E1.*xi.^2.*(0.966463E0+ ...
  0.141639E0.*tanh(w)).^2).^(-1).*(0.318511E1+0.370285E1.*xi.*(0.966463E0+ ...
  0.141639E0.*tanh(w))+0.381991E1.*xi.^2.*(0.966463E0+0.141639E0.*tanh(w)) ...
  .^2+0.790497E0.*xi.^3.*(0.966463E0+0.141639E0.*tanh(w)).^3))).^(-1/2)) ...
  .^(-1);

%{
   
for jdc = 0 and mu = 24.17

ff[11.5,jdc] = 9.83553

phi0avg[0.4, 6.,jdc] = 6.43176

niw[.2, .3, 13,jdc] = 0.0764645

niww[0.2, 0.3, 0.4, 13,jdc] = 0.140776

yd[0.2, 0.3, 0.4, 13,jdc] = 0. - 0.0257383 i

he[10.5,jdc] = 0.120617

ye[0.4, 3.6,jdc] = 0.144533

yi[0.2, 0.3, 0.4, 13,jdc] = 0.00654387 - 0.0137273 i

ytot[0.2, 0.3, 0.4, 13,jdc] = 0.0477729 -0.0394656 i
   
%}