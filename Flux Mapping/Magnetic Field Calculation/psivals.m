%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%function vals=psivals(rvec,zvec,psi,zloc,rlocs)%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Written by R. H. Goulding 12/4/98% Function to calculate psi values for contours which pass through a user-% specified set of r locations at a user specified z location.% To be used with Matlab "contour" function.  % INPUTS:% % rvec      vector containing radial locations at which psi is calculated.% zvec      vector containing axial locations at which psi is calculated.% psi       array of size length(rvec) X length (zvec) containing axial %           magnetic flux values.% zloc      z location at which r locations for contours to pass through%           are specified.% rlocs     vector containing radial locations for contours to pass through%           at z location zloc.% OUTPUT:% % vals      vector of psi values which produce contours passing through the%           specified r locations at the specified z location.% USAGE:  After running a function to calculate psi, such as B_coaxial_coils.m,%         run psivals.m to produce the vector vals. Then use the contour %         command to plot contours: contour(zvec,rvec,psi,vals)%         The contours plotted will pass through the radial locations specified%         by rlocs at the axial location zloc.ix=1:length(zvec)-1;iloc=find((zvec(ix) <= zloc)&(zvec(ix+1) > zloc));psi_z=(zloc-zvec(iloc))/(zvec(iloc+1)-zvec(iloc))*(psi(:,iloc+1)-psi(:,iloc))+psi(:,iloc);vals=interp1(rvec,psi_z',rlocs);% Done