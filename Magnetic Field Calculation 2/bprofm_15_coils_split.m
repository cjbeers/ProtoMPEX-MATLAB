fontsize=14;fontweight='normal';tube_x=[1.1,1.9,1.9,1.1,1.1];tube_y=[.025,.025,.027,.027,.025]*3;ant_x=[2.03,2.18,2.18,2.03,2.03];ant_y=[.028,.028,.034,.034,.028];lhres=.1650;b_lh_x=[0,1];b_lh_y=[1,1]*lhres;rlocs=[.01,.02,.03,.04,.05,.06,.0625];%cursav=cur;%splitcoils=[5,6,9,10,14,15];%cur(splitcoils)=cur(splitcoils)*7./7;[br,bz,psi]=B_coaxial_coilsm(brg,bzg,atg,avec,cur);%cur=cursav;bt=sqrt(br.^2+bz.^2);bt0=bt(1,:);bta=bt(1,:);bma=max(bta);%xloc_left=find(zvec < tube_x(1));xloc_left=find(zvec<1.7,1,'last');%xloc_left=max(xloc_left);xloc_right=find(zvec >1.8,1,'first');%xloc_right=min(xloc_right);bmina=min(bta(xloc_left:xloc_right));bmloc=find(bta(xloc_left:xloc_right)==bmina)+xloc_left-1;disp(bta(bmloc))m1_x=[z0(1),z0(1)+cl(1),z0(1)+cl(1),z0(1),z0(1)];m2_x=[z0(2),z0(2)+cl(2),z0(2)+cl(2),z0(2),z0(2)];m3_x=[z0(3),z0(3)+cl(3),z0(3)+cl(3),z0(3),z0(3)];m4_x=[z0(4),z0(4)+cl(4),z0(4)+cl(4),z0(4),z0(4)];m5_x=[z0(5),z0(5)+cl(5),z0(5)+cl(5),z0(5),z0(5)];m6_x=[z0(6),z0(6)+cl(6),z0(6)+cl(6),z0(6),z0(6)];m7_x=[z0(7),z0(7)+cl(7),z0(7)+cl(7),z0(7),z0(7)];m8_x=[z0(8),z0(8)+cl(8),z0(8)+cl(8),z0(8),z0(8)];m9_x=[z0(9),z0(9)+cl(9),z0(9)+cl(9),z0(9),z0(9)];m10_x=[z0(10),z0(10)+cl(10),z0(10)+cl(10),z0(10),z0(10)];m11_x=[z0(11),z0(11)+cl(11),z0(11)+cl(11),z0(11),z0(11)];m12_x=[z0(12),z0(12)+cl(12),z0(12)+cl(12),z0(12),z0(12)];m13_x=[z0(13),z0(13)+cl(13),z0(13)+cl(13),z0(13),z0(13)];m14_x=[z0(14),z0(14)+cl(14),z0(14)+cl(14),z0(14),z0(14)];m15_x=[z0(15),z0(15)+cl(15),z0(15)+cl(15),z0(15),z0(15)];m_y=[0,0,bma,bma,0];vals=psivals(avec,zvec,psi,zvec(bmloc),rlocs);disp(zvec(bmloc))subplot(2,1,1);hold offcontour(zvec,avec,psi,vals,'b');hold oncontour(zvec,avec,psi,[vals(7),vals(7)],'r');%plot(tube_x,tube_y,'c',ant_x,ant_y,'r');gridtitle('Flux tube mapping');ylabel('R  (m)');xlabel('Z  (m)');axis([0,zmax,0,.5])set(gca,'Fontsize',12,'fontweight','normal');set(findall(gcf,'type','text'),'fontsize',fontsize,'fontweight',fontweight)subplot(2,1,2)plot(zvec,bt(1,:),'b',m1_x,m_y,'r',m2_x,m_y,'r',m3_x,m_y,'r',m4_x,m_y,'r',...                      m5_x,m_y,'r',m6_x,m_y,'r',m7_x,m_y,'r',m8_x,m_y,'r',...                      m9_x,m_y,'r',m10_x,m_y,'r',m11_x,m_y,'r',m12_x,m_y,'r',...                      m13_x,m_y,'r',m14_x,m_y,'r',m15_x,m_y,'r');gridtitle('mod B on axis');ylabel('|B|  (T)');xlabel('Z  (m)');                  text(m1_x(1)+.15*cl(1),0.05*bma,'1');text(m2_x(1)+.15*cl(1),0.05*bma,'2');text(m3_x(1)+.15*cl(1),0.05*bma,'3');text(m4_x(1)+.15*cl(1),0.05*bma,'4');text(m5_x(1)+.15*cl(1),0.05*bma,'5a');text(m6_x(1)+.15*cl(1),0.05*bma,'5b');text(m7_x(1)+.15*cl(1),0.05*bma,'6');text(m8_x(1)+.15*cl(1),0.05*bma,'7');text(m9_x(1)+.15*cl(1),0.05*bma,'8a');text(m10_x(1)+.15*cl(1),0.05*bma,'8b');text(m11_x(1)+.15*cl(1),0.05*bma,'9');text(m12_x(1)+.15*cl(1),0.05*bma,'10');text(m13_x(1)+.15*cl(1),0.05*bma,'11');text(m14_x(1)+.15*cl(1),0.05*bma,'12a');text(m15_x(1)+.15*cl(1),0.05*bma,'12b');%for ii=1:14,text(z0(ii)+cl(1)/4,1.05*bma,num2str(ii));endtextout1=['C1 = ',num2str(cur(1)),' amps   ',...         'C2 = ',num2str(cur(2)),' amps   ',...		 'C3 = ',num2str(cur(3)),' amps   ',...         'C4 = ',num2str(cur(4)),' amps   ',...         'C5a = ',num2str(cur(5)),' amps   ',...         'C5b = ',num2str(cur(6)),' amps'];         textout2=['C6 = ',num2str(cur(7)),' amps  ',...          'C7 = ',num2str(cur(8)),' amps   ',...          'C8a = ',num2str(cur(9)),' amps   ',...		  'C8b = ',num2str(cur(10)),' amps   ',...          'C9 = ',num2str(cur(11)),' amps   ',...          'C10 = ',num2str(cur(12)),' amps']; textout3=['C11 = ',num2str(cur(13)),' amps   ',...          'C12a = ',num2str(cur(14)),' amps   ',...          'C12b = ',num2str(cur(15)),' amps   '];locs=axis;		 text(-.1*locs(2),-.2*locs(4),textout1);	text(-.1*locs(2),-.25*locs(4),textout2);text(-.1*locs(2),-.3*locs(4),textout3);axis([0,zmax,locs(3),locs(4)]);set(gca,'Fontsize',12,'fontweight','normal');set(findall(gcf,'type','text'),'fontsize',fontsize,'fontweight',fontweight)hold off